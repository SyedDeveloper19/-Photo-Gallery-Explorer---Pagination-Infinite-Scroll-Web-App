<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Photo Gallery Explorer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-bottom: 40px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            display: block;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .search-box {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        
        .search-box input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 1px solid #e1e5eb;
            border-radius: 50px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .search-box input:focus {
            outline: none;
            border-color: #2575fc;
            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.2);
        }
        
        .search-box i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #6c757d;
        }
        
        .filter-controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .items-per-page {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .items-per-page select {
            padding: 10px 15px;
            border: 1px solid #e1e5eb;
            border-radius: 5px;
            background-color: white;
            font-size: 1rem;
        }
        
        .category-filter {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .category-filter select {
            padding: 10px 15px;
            border: 1px solid #e1e5eb;
            border-radius: 5px;
            background-color: white;
            font-size: 1rem;
            min-width: 150px;
        }
        
        .view-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .view-toggle button {
            background-color: #f8f9fa;
            border: 1px solid #e1e5eb;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .view-toggle button.active {
            background-color: #2575fc;
            color: white;
            border-color: #2575fc;
        }
        
        .view-toggle button:hover:not(.active) {
            background-color: #e9ecef;
        }
        
        .items-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 2rem;
            min-height: 500px;
        }
        
        .item-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 0.5s forwards;
            cursor: pointer;
        }
        
        .item-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .item-card.new-item {
            animation: highlight 1.5s ease;
        }
        
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes highlight {
            0%,
            100% {
                background-color: white;
            }
            50% {
                background-color: #f0f8ff;
            }
        }
        
        .item-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            background-color: #f1f3f4;
            transition: transform 0.5s ease;
        }
        
        .item-card:hover .item-image {
            transform: scale(1.05);
        }
        
        .item-content {
            padding: 1.5rem;
        }
        
        .item-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: #2c3e50;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .item-description {
            color: #6c757d;
            font-size: 0.95rem;
            margin-bottom: 1.2rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .item-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .item-id {
            display: inline-block;
            background-color: #f8f9fa;
            color: #6c757d;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .item-category {
            display: inline-block;
            color: white;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .item-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #adb5bd;
        }
        
        .item-likes {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .item-likes i {
            color: #ff6b6b;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .item-likes i:hover {
            color: #ff4757;
        }
        
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2.5rem 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .pagination-btn {
            background-color: white;
            border: 1px solid #e1e5eb;
            padding: 10px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background-color: #f8f9fa;
            border-color: #2575fc;
        }
        
        .pagination-btn.active {
            background-color: #2575fc;
            color: white;
            border-color: #2575fc;
        }
        
        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .page-numbers {
            display: flex;
            gap: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 30px;
            font-size: 1.1rem;
            color: #6c757d;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(37, 117, 252, 0.3);
            border-radius: 50%;
            border-top-color: #2575fc;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        .skeleton {
            background-color: #e0e0e0;
            border-radius: 4px;
            animation: skeleton-pulse 1.5s ease-in-out infinite;
        }
        
        @keyframes skeleton-pulse {
            0%,
            100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .skeleton-image {
            width: 100%;
            height: 220px;
        }
        
        .skeleton-title {
            width: 80%;
            height: 24px;
            margin-bottom: 10px;
        }
        
        .skeleton-description {
            width: 100%;
            height: 60px;
            margin-bottom: 15px;
        }
        
        .skeleton-id {
            width: 50px;
            height: 20px;
        }
        
        .no-results {
            text-align: center;
            padding: 60px 20px;
            grid-column: 1 / -1;
        }
        
        .no-results i {
            font-size: 3rem;
            color: #6c757d;
            margin-bottom: 1rem;
        }
        
        .no-results h3 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #495057;
        }
        
        .no-results p {
            color: #6c757d;
        }
        
        .scroll-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #2575fc;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(37, 117, 252, 0.3);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s;
            cursor: pointer;
            z-index: 100;
        }
        
        .scroll-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(-50px);
            transition: transform 0.3s;
        }
        
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            z-index: 10;
        }
        
        .modal-image {
            width: 100%;
            max-height: 500px;
            object-fit: cover;
            border-radius: 15px 15px 0 0;
        }
        
        .modal-body {
            padding: 2rem;
        }
        
        .modal-title {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: #2c3e50;
        }
        
        .modal-description {
            color: #6c757d;
            line-height: 1.6;
            margin-bottom: 1.5rem;
        }
        
        .modal-meta {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 1.5rem;
        }
        
        .modal-meta-item {
            display: flex;
            flex-direction: column;
        }
        
        .modal-meta-label {
            font-size: 0.9rem;
            color: #adb5bd;
            margin-bottom: 5px;
        }
        
        .modal-meta-value {
            font-weight: 500;
            color: #495057;
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 2rem;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .modal-btn-like {
            background-color: #ff6b6b;
            color: white;
        }
        
        .modal-btn-like:hover {
            background-color: #ff4757;
        }
        
        .modal-btn-download {
            background-color: #2575fc;
            color: white;
        }
        
        .modal-btn-download:hover {
            background-color: #1a68e8;
        }
        
        .modal-btn-close {
            background-color: #f8f9fa;
            color: #495057;
        }
        
        .modal-btn-close:hover {
            background-color: #e9ecef;
        }
        
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background-color: #2575fc;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        .sort-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sort-controls select {
            padding: 10px 15px;
            border: 1px solid #e1e5eb;
            border-radius: 5px;
            background-color: white;
            font-size: 1rem;
            min-width: 150px;
        }
        
        .dark-mode-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .dark-mode-toggle button {
            background-color: #f8f9fa;
            border: 1px solid #e1e5eb;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .dark-mode-toggle button:hover {
            background-color: #e9ecef;
        }
        
        .dark-mode {
            background-color: #1a1a2e;
            color: #e0e0e0;
        }
        
        .dark-mode header {
            background: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
        }
        
        .dark-mode .controls,
        .dark-mode .item-card,
        .dark-mode .modal-content {
            background-color: #2d2d44;
            color: #e0e0e0;
        }
        
        .dark-mode .item-title,
        .dark-mode .modal-title {
            color: #e0e0e0;
        }
        
        .dark-mode .item-description,
        .dark-mode .modal-description {
            color: #b0b0b0;
        }
        
        .dark-mode .search-box input,
        .dark-mode select,
        .dark-mode .pagination-btn,
        .dark-mode .view-toggle button,
        .dark-mode .dark-mode-toggle button {
            background-color: #2d2d44;
            border-color: #444;
            color: #e0e0e0;
        }
        
        .dark-mode .search-box input:focus {
            border-color: #2575fc;
        }
        
        footer {
            text-align: center;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #e1e5eb;
            color: #6c757d;
        }
        
        .dark-mode footer {
            border-top-color: #444;
            color: #b0b0b0;
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            .search-box {
                min-width: 100%;
            }
            .filter-controls {
                width: 100%;
                justify-content: center;
            }
            .items-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            .pagination-container {
                flex-direction: column;
                gap: 15px;
            }
            .page-numbers {
                order: -1;
            }
            .modal-content {
                width: 95%;
            }
        }
        
        @media (max-width: 480px) {
            .items-container {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 2rem;
            }
            .modal-body {
                padding: 1.5rem;
            }
            .modal-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <h1>Photo Gallery Explorer</h1>
            <p class="subtitle">Discover beautiful images with pagination, infinite scroll, and powerful filters</p>

            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-value" id="totalItemsCount">0</span>
                    <span class="stat-label">Total Items</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="filteredItemsCount">0</span>
                    <span class="stat-label">Filtered Items</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="currentPageDisplay">1</span>
                    <span class="stat-label">Current Page</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="totalPagesDisplay">1</span>
                    <span class="stat-label">Total Pages</span>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search images by title, description, or category...">
            </div>

            <div class="filter-controls">
                <div class="items-per-page">
                    <span>Show:</span>
                    <select id="itemsPerPage">
                        <option value="6">6</option>
                        <option value="10" selected>10</option>
                        <option value="15">15</option>
                        <option value="20">20</option>
                    </select>
                </div>

                <div class="category-filter">
                    <span>Category:</span>
                    <select id="categoryFilter">
                        <option value="all">All Categories</option>
                        <!-- Categories will be populated dynamically -->
                    </select>
                </div>

                <div class="sort-controls">
                    <span>Sort by:</span>
                    <select id="sortBy">
                        <option value="id">Default (ID)</option>
                        <option value="title">Title A-Z</option>
                        <option value="category">Category</option>
                        <option value="likes">Most Liked</option>
                    </select>
                </div>
            </div>

            <div class="view-toggle">
                <span>View:</span>
                <button id="paginationView" class="active">
                    <i class="fas fa-th-list"></i> Pagination
                </button>
                <button id="infiniteScrollView">
                    <i class="fas fa-infinity"></i> Infinite Scroll
                </button>
            </div>

            <div class="dark-mode-toggle">
                <button id="darkModeToggle">
                    <i class="fas fa-moon"></i> Dark Mode
                </button>
            </div>
        </div>

        <div id="itemsContainer" class="items-container">
            <!-- Items will be loaded here -->
        </div>

        <div id="paginationContainer" class="pagination-container">
            <!-- Pagination buttons will be loaded here -->
        </div>

        <div id="loadingIndicator" class="loading" style="display: none;">
            <div class="loading-spinner"></div>
            Loading more images...
        </div>

        <div id="noResults" class="no-results" style="display: none;">
            <i class="fas fa-search"></i>
            <h3>No images found</h3>
            <p>Try adjusting your search or filter to find what you're looking for.</p>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-close" id="modalClose">
                <i class="fas fa-times"></i>
            </div>
            <img id="modalImage" class="modal-image" src="" alt="">
            <div class="modal-body">
                <h2 id="modalTitle" class="modal-title"></h2>
                <p id="modalDescription" class="modal-description"></p>

                <div class="modal-meta">
                    <div class="modal-meta-item">
                        <span class="modal-meta-label">ID</span>
                        <span id="modalId" class="modal-meta-value"></span>
                    </div>
                    <div class="modal-meta-item">
                        <span class="modal-meta-label">Category</span>
                        <span id="modalCategory" class="modal-meta-value"></span>
                    </div>
                    <div class="modal-meta-item">
                        <span class="modal-meta-label">Photographer</span>
                        <span id="modalPhotographer" class="modal-meta-value"></span>
                    </div>
                    <div class="modal-meta-item">
                        <span class="modal-meta-label">Likes</span>
                        <span id="modalLikes" class="modal-meta-value"></span>
                    </div>
                    <div class="modal-meta-item">
                        <span class="modal-meta-label">Downloads</span>
                        <span id="modalDownloads" class="modal-meta-value"></span>
                    </div>
                </div>

                <div class="modal-actions">
                    <button class="modal-btn modal-btn-like" id="modalLikeBtn">
                        <i class="fas fa-heart"></i> Like
                    </button>
                    <button class="modal-btn modal-btn-download" id="modalDownloadBtn">
                        <i class="fas fa-download"></i> Download
                    </button>
                    <button class="modal-btn modal-btn-close" id="modalCloseBtn">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast"></div>

    <div id="scrollToTop" class="scroll-indicator">
        <i class="fas fa-arrow-up"></i>
    </div>

    <footer class="container">
        <p>Photo Gallery Explorer • <span id="totalItems">0</span> images loaded • Page <span id="currentPage">1</span> of <span id="totalPages">1</span></p>
        <p>Images from
            <a href="https://picsum.photos" target="_blank" style="color: #2575fc;">Enjoy</a> • Made with Syed</p>
    </footer>

    <script>
        // State management
        const state = {
            items: [],
            filteredItems: [],
            currentPage: 1,
            itemsPerPage: 10,
            totalPages: 1,
            isLoading: false,
            viewMode: 'pagination',
            searchQuery: '',
            selectedCategory: 'all',
            sortBy: 'id',
            darkMode: false,
            lastScrollPosition: 0,
            likedItems: new Set(),
            viewedItems: new Set()
        };

        // Real image categories with colors
        const imageCategories = [{
            name: 'Nature',
            color: '#2ecc71',
            keywords: ['forest', 'mountain', 'ocean', 'tree', 'flower', 'river']
        }, {
            name: 'City',
            color: '#3498db',
            keywords: ['building', 'urban', 'skyline', 'street', 'architecture']
        }, {
            name: 'Travel',
            color: '#e74c3c',
            keywords: ['landmark', 'tourism', 'destination', 'culture', 'adventure']
        }, {
            name: 'Technology',
            color: '#9b59b6',
            keywords: ['computer', 'gadget', 'device', 'innovation', 'digital']
        }, {
            name: 'Food',
            color: '#e67e22',
            keywords: ['meal', 'cuisine', 'restaurant', 'cooking', 'delicious']
        }, {
            name: 'People',
            color: '#1abc9c',
            keywords: ['portrait', 'person', 'human', 'face', 'expression']
        }, {
            name: 'Animals',
            color: '#f1c40f',
            keywords: ['wildlife', 'pet', 'bird', 'mammal', 'creature']
        }, {
            name: 'Sports',
            color: '#e74c3c',
            keywords: ['athlete', 'game', 'competition', 'fitness', 'activity']
        }, {
            name: 'Art',
            color: '#9b59b6',
            keywords: ['painting', 'sculpture', 'design', 'creative', 'museum']
        }, {
            name: 'Fashion',
            color: '#ff6b8b',
            keywords: ['clothing', 'style', 'model', 'designer', 'trend']
        }];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            // Generate mock data with real images
            generateMockData();

            // Initialize event listeners
            initEventListeners();

            // Populate category filter
            populateCategoryFilter();

            // Load initial items
            updateDisplay();

            // Try to restore from localStorage
            restoreState();
        });

        // Generate mock data with real images
        function generateMockData() {
            const titles = [
                'Beautiful Mountain Landscape at Sunrise',
                'Modern City Skyline at Night',
                'Delicious Gourmet Pizza with Fresh Ingredients',
                'Cute Puppy Playing in the Park',
                'Vintage Car on Country Road',
                'Professional Athlete in Action',
                'Colorful Street Art in Urban Setting',
                'Peaceful Beach with Crystal Clear Water',
                'High-Tech Gadgets and Devices',
                'Traditional Cultural Festival Celebration',
                'Wild Elephant in Natural Habitat',
                'Coffee Shop with Cozy Atmosphere',
                'Ancient Historical Architecture',
                'Starry Night Sky Over Desert',
                'Fresh Organic Vegetables from Farm',
                'Busy Market in Southeast Asia',
                'Snowy Mountain Peak Adventure',
                'Fashion Model in Studio Shoot',
                'Beautiful Flower Garden in Spring',
                'Luxury Yacht on Mediterranean Sea'
            ];

            const descriptions = [
                'A breathtaking view of majestic mountains during golden hour sunrise, with clouds forming patterns in the sky.',
                'Urban landscape illuminated by thousands of city lights creating a mesmerizing pattern against the night sky.',
                'Artisanal pizza fresh from a wood-fired oven with premium ingredients including fresh basil and mozzarella.',
                'Adorable golden retriever puppy enjoying a sunny day playing with a ball in the green park.',
                'Classic vintage automobile driving through a scenic countryside road surrounded by autumn foliage.',
                'Professional basketball player making an incredible dunk during an intense championship game.',
                'Vibrant graffiti art transforming a dull urban wall into a masterpiece of color and creativity.',
                'Tropical paradise with white sandy beaches and turquoise waters under clear blue skies.',
                'Cutting-edge technology devices including smartphones, laptops, and smartwatches in a minimalist setup.',
                'Traditional dancers in colorful costumes celebrating local culture during an annual festival parade.'
            ];

            const photographers = [
                'Alex Johnson', 'Maria Garcia', 'David Chen', 'Sophie Williams', 'James Wilson',
                'Emma Brown', 'Michael Taylor', 'Olivia Davis', 'Daniel Martinez', 'Sarah Anderson'
            ];

            // Create 80 items with real images
            for (let i = 1; i <= 80; i++) {
                const category = imageCategories[Math.floor(Math.random() * imageCategories.length)];
                const title = titles[Math.floor(Math.random() * titles.length)];
                const description = descriptions[Math.floor(Math.random() * descriptions.length)];
                const photographer = photographers[Math.floor(Math.random() * photographers.length)];

                // Use Picsum photos with different dimensions
                const width = 400 + Math.floor(Math.random() * 200);
                const height = 300 + Math.floor(Math.random() * 150);
                const imageId = 10 + i; // Sequential IDs for consistent images

                // Add some variety to images
                const useGrayscale = Math.random() > 0.8;
                const useBlur = Math.random() > 0.9;

                let imageUrl = `https://picsum.photos/id/${imageId}/${width}/${height}`;

                // Apply filters randomly
                if (useGrayscale) imageUrl += '?grayscale';
                if (useBlur) imageUrl += (useGrayscale ? '&' : '?') + `blur=${Math.floor(Math.random() * 3) + 1}`;

                state.items.push({
                    id: i,
                    title: `${title}`,
                    description: `${description} This image was captured by professional photographer ${photographer}.`,
                    category: category.name,
                    categoryColor: category.color,
                    imageUrl: imageUrl,
                    photographer: photographer,
                    likes: Math.floor(Math.random() * 100),
                    downloads: Math.floor(Math.random() * 500),
                    dateAdded: new Date(Date.now() - Math.floor(Math.random() * 10000000000)).toISOString().split('T')[0]
                });
            }

            state.filteredItems = [...state.items];
        }

        // Populate category filter dropdown
        function populateCategoryFilter() {
            const categoryFilter = document.getElementById('categoryFilter');

            // Clear existing options except "All Categories"
            while (categoryFilter.options.length > 1) {
                categoryFilter.remove(1);
            }

            // Add category options
            imageCategories.forEach(category => {
                const option = document.createElement('option');
                option.value = category.name;
                option.textContent = category.name;
                categoryFilter.appendChild(option);
            });
        }

        // Initialize event listeners
        function initEventListeners() {
            // Search input
            document.getElementById('searchInput').addEventListener('input', (e) => {
                state.searchQuery = e.target.value.toLowerCase();
                state.currentPage = 1;
                updateDisplay();
            });

            // Items per page select
            document.getElementById('itemsPerPage').addEventListener('change', (e) => {
                state.itemsPerPage = parseInt(e.target.value);
                state.currentPage = 1;
                updateDisplay();
                saveState();
            });

            // Category filter
            document.getElementById('categoryFilter').addEventListener('change', (e) => {
                state.selectedCategory = e.target.value;
                state.currentPage = 1;
                updateDisplay();
            });

            // Sort by
            document.getElementById('sortBy').addEventListener('change', (e) => {
                state.sortBy = e.target.value;
                state.currentPage = 1;
                updateDisplay();
            });

            // View mode toggle
            document.getElementById('paginationView').addEventListener('click', () => {
                if (state.viewMode !== 'pagination') {
                    state.viewMode = 'pagination';
                    document.getElementById('paginationView').classList.add('active');
                    document.getElementById('infiniteScrollView').classList.remove('active');
                    updateDisplay();
                    saveState();
                }
            });

            document.getElementById('infiniteScrollView').addEventListener('click', () => {
                if (state.viewMode !== 'infinite') {
                    state.viewMode = 'infinite';
                    document.getElementById('infiniteScrollView').classList.add('active');
                    document.getElementById('paginationView').classList.remove('active');
                    updateDisplay();
                    saveState();
                }
            });

            // Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', () => {
                state.darkMode = !state.darkMode;
                document.body.classList.toggle('dark-mode', state.darkMode);
                document.getElementById('darkModeToggle').innerHTML =
                    state.darkMode ? '<i class="fas fa-sun"></i> Light Mode' : '<i class="fas fa-moon"></i> Dark Mode';
                saveState();
            });

            // Scroll to top button
            document.getElementById('scrollToTop').addEventListener('click', () => {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });

            // Infinite scroll listener
            window.addEventListener('scroll', handleScroll);

            // Show/hide scroll to top button
            window.addEventListener('scroll', () => {
                const scrollToTopBtn = document.getElementById('scrollToTop');
                if (window.scrollY > 300) {
                    scrollToTopBtn.classList.add('show');
                } else {
                    scrollToTopBtn.classList.remove('show');
                }

                // Save scroll position
                state.lastScrollPosition = window.scrollY;
            });

            // Modal close buttons
            document.getElementById('modalClose').addEventListener('click', closeModal);
            document.getElementById('modalCloseBtn').addEventListener('click', closeModal);

            // Modal like button
            document.getElementById('modalLikeBtn').addEventListener('click', handleLike);

            // Modal download button
            document.getElementById('modalDownloadBtn').addEventListener('click', handleDownload);

            // Close modal on overlay click
            document.getElementById('imageModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('imageModal')) {
                    closeModal();
                }
            });
        }

        // Handle infinite scroll
        function handleScroll() {
            if (state.viewMode !== 'infinite' || state.isLoading) return;

            const scrollPosition = window.innerHeight + window.scrollY;
            const pageHeight = document.documentElement.scrollHeight - 100;

            if (scrollPosition >= pageHeight && state.currentPage < state.totalPages) {
                loadNextPage();
            }
        }

        // Filter and sort items
        function filterAndSortItems() {
            // Start with all items
            let filtered = [...state.items];

            // Apply search filter
            if (state.searchQuery.trim()) {
                filtered = filtered.filter(item =>
                    item.title.toLowerCase().includes(state.searchQuery) ||
                    item.description.toLowerCase().includes(state.searchQuery) ||
                    item.category.toLowerCase().includes(state.searchQuery) ||
                    item.photographer.toLowerCase().includes(state.searchQuery)
                );
            }

            // Apply category filter
            if (state.selectedCategory !== 'all') {
                filtered = filtered.filter(item => item.category === state.selectedCategory);
            }

            // Apply sorting
            filtered.sort((a, b) => {
                switch (state.sortBy) {
                    case 'title':
                        return a.title.localeCompare(b.title);
                    case 'category':
                        return a.category.localeCompare(b.category);
                    case 'likes':
                        return b.likes - a.likes;
                    case 'id':
                    default:
                        return a.id - b.id;
                }
            });

            state.filteredItems = filtered;

            // Calculate total pages
            state.totalPages = Math.ceil(state.filteredItems.length / state.itemsPerPage);

            // Reset to page 1 if current page is beyond total pages
            if (state.currentPage > state.totalPages && state.totalPages > 0) {
                state.currentPage = 1;
            }
        }

        // Update the display based on current state
        function updateDisplay() {
            filterAndSortItems();

            // Get current page items
            const startIndex = (state.currentPage - 1) * state.itemsPerPage;
            const endIndex = startIndex + state.itemsPerPage;
            const currentItems = state.filteredItems.slice(startIndex, endIndex);

            // Show/hide no results message
            const noResultsEl = document.getElementById('noResults');
            if (state.filteredItems.length === 0) {
                noResultsEl.style.display = 'block';
            } else {
                noResultsEl.style.display = 'none';
            }

            // Render items
            renderItems(currentItems);

            // Update pagination if in pagination mode
            if (state.viewMode === 'pagination') {
                renderPagination();
            } else {
                // Hide pagination in infinite scroll mode
                document.getElementById('paginationContainer').innerHTML = '';
            }

            // Update stats
            updateStats();

            // Save state to localStorage
            saveState();
        }

        // Update statistics
        function updateStats() {
            document.getElementById('totalItemsCount').textContent = state.items.length;
            document.getElementById('filteredItemsCount').textContent = state.filteredItems.length;
            document.getElementById('currentPageDisplay').textContent = state.currentPage;
            document.getElementById('totalPagesDisplay').textContent = state.totalPages;

            document.getElementById('totalItems').textContent = state.filteredItems.length;
            document.getElementById('currentPage').textContent = state.currentPage;
            document.getElementById('totalPages').textContent = state.totalPages;
        }

        // Render items to the container
        function renderItems(items) {
            const container = document.getElementById('itemsContainer');

            // If we're on page 1 in infinite scroll mode, clear the container
            // Otherwise, we'll append new items
            if (state.viewMode === 'pagination' || state.currentPage === 1) {
                container.innerHTML = '';
            }

            // Show skeleton loaders while loading
            if (state.isLoading && state.viewMode === 'infinite' && state.currentPage > 1) {
                const skeletonCount = Math.min(state.itemsPerPage, state.filteredItems.length - (state.currentPage - 1) * state.itemsPerPage);
                for (let i = 0; i < skeletonCount; i++) {
                    const skeletonEl = document.createElement('div');
                    skeletonEl.className = 'item-card';
                    skeletonEl.innerHTML = `
                        <div class="skeleton skeleton-image"></div>
                        <div class="item-content">
                            <div class="skeleton skeleton-title"></div>
                            <div class="skeleton skeleton-description"></div>
                            <div class="skeleton skeleton-id"></div>
                        </div>
                    `;
                    container.appendChild(skeletonEl);
                }
                return;
            }

            // If no items to display
            if (items.length === 0 && state.currentPage === 1) {
                return;
            }

            // Create and append item cards
            items.forEach((item, index) => {
                const itemEl = document.createElement('div');
                itemEl.className = 'item-card';
                itemEl.dataset.id = item.id;

                // Check if item is liked
                const isLiked = state.likedItems.has(item.id);

                itemEl.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.title}" class="item-image" loading="lazy">
                    <div class="item-content">
                        <h3 class="item-title">${item.title}</h3>
                        <p class="item-description">${item.description}</p>
                        <div class="item-meta">
                            <span class="item-id">#${item.id}</span>
                            <span class="item-category" style="background-color: ${item.categoryColor}">${item.category}</span>
                        </div>
                        <div class="item-footer">
                            <div class="item-likes">
                                <i class="${isLiked ? 'fas' : 'far'} fa-heart" data-id="${item.id}"></i>
                                <span>${item.likes}</span>
                            </div>
                            <div class="item-date">${item.dateAdded}</div>
                        </div>
                    </div>
                `;

                // Add animation delay for staggered appearance
                itemEl.style.animationDelay = `${index * 0.05}s`;

                // Mark as new if we just loaded it
                if (state.viewMode === 'infinite' && state.currentPage > 1) {
                    setTimeout(() => {
                        itemEl.classList.add('new-item');
                        setTimeout(() => {
                            itemEl.classList.remove('new-item');
                        }, 1500);
                    }, 100);
                }

                // Add click event to open modal
                itemEl.addEventListener('click', (e) => {
                    // Don't open modal if clicking on like button
                    if (!e.target.closest('.item-likes')) {
                        openModal(item);
                    }
                });

                // Add like button event
                const likeBtn = itemEl.querySelector('.item-likes i');
                likeBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    toggleLike(item.id);
                });

                container.appendChild(itemEl);
            });
        }

        // Render pagination controls
        function renderPagination() {
            const container = document.getElementById('paginationContainer');

            // Clear previous pagination
            container.innerHTML = '';

            // Don't show pagination if no items or only one page
            if (state.filteredItems.length === 0 || state.totalPages <= 1) {
                return;
            }

            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = 'pagination-btn';
            prevBtn.id = 'prevBtn';
            prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i> Previous';
            prevBtn.disabled = state.currentPage === 1;
            prevBtn.addEventListener('click', () => {
                if (state.currentPage > 1) {
                    state.currentPage--;
                    updateDisplay();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            });

            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = 'pagination-btn';
            nextBtn.id = 'nextBtn';
            nextBtn.innerHTML = 'Next <i class="fas fa-chevron-right"></i>';
            nextBtn.disabled = state.currentPage === state.totalPages;
            nextBtn.addEventListener('click', () => {
                if (state.currentPage < state.totalPages) {
                    state.currentPage++;
                    updateDisplay();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            });

            // Page numbers container
            const pageNumbers = document.createElement('div');
            pageNumbers.className = 'page-numbers';

            // Determine which page numbers to show
            let startPage = Math.max(1, state.currentPage - 2);
            let endPage = Math.min(state.totalPages, startPage + 4);

            // Adjust if we're near the end
            if (endPage - startPage < 4 && startPage > 1) {
                startPage = Math.max(1, endPage - 4);
            }

            // First page button
            if (startPage > 1) {
                const firstPageBtn = document.createElement('button');
                firstPageBtn.className = 'pagination-btn';
                firstPageBtn.textContent = '1';
                firstPageBtn.addEventListener('click', () => {
                    state.currentPage = 1;
                    updateDisplay();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
                pageNumbers.appendChild(firstPageBtn);

                if (startPage > 2) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'pagination-btn';
                    ellipsis.textContent = '...';
                    ellipsis.style.cursor = 'default';
                    ellipsis.disabled = true;
                    pageNumbers.appendChild(ellipsis);
                }
            }

            // Numbered page buttons
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = 'pagination-btn';
                pageBtn.textContent = i;

                if (i === state.currentPage) {
                    pageBtn.classList.add('active');
                }

                pageBtn.addEventListener('click', () => {
                    state.currentPage = i;
                    updateDisplay();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });

                pageNumbers.appendChild(pageBtn);
            }

            // Last page button
            if (endPage < state.totalPages) {
                if (endPage < state.totalPages - 1) {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'pagination-btn';
                    ellipsis.textContent = '...';
                    ellipsis.style.cursor = 'default';
                    ellipsis.disabled = true;
                    pageNumbers.appendChild(ellipsis);
                }

                const lastPageBtn = document.createElement('button');
                lastPageBtn.className = 'pagination-btn';
                lastPageBtn.textContent = state.totalPages;
                lastPageBtn.addEventListener('click', () => {
                    state.currentPage = state.totalPages;
                    updateDisplay();
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                });
                pageNumbers.appendChild(lastPageBtn);
            }

            // Append all elements to container
            container.appendChild(prevBtn);
            container.appendChild(pageNumbers);
            container.appendChild(nextBtn);
        }

        // Load next page (for infinite scroll)
        function loadNextPage() {
            if (state.isLoading || state.currentPage >= state.totalPages) return;

            state.isLoading = true;

            // Show loading indicator
            const loadingIndicator = document.getElementById('loadingIndicator');
            loadingIndicator.style.display = 'block';

            // Simulate API delay
            setTimeout(() => {
                state.currentPage++;
                state.isLoading = false;
                loadingIndicator.style.display = 'none';
                updateDisplay();
            }, 800);
        }

        // Open modal with item details
        function openModal(item) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');
            const modalId = document.getElementById('modalId');
            const modalCategory = document.getElementById('modalCategory');
            const modalPhotographer = document.getElementById('modalPhotographer');
            const modalLikes = document.getElementById('modalLikes');
            const modalDownloads = document.getElementById('modalDownloads');

            // Set modal content
            modalImage.src = item.imageUrl;
            modalImage.alt = item.title;
            modalTitle.textContent = item.title;
            modalDescription.textContent = item.description;
            modalId.textContent = `#${item.id}`;
            modalCategory.textContent = item.category;
            modalPhotographer.textContent = item.photographer;
            modalLikes.textContent = item.likes;
            modalDownloads.textContent = item.downloads;

            // Set modal like button state
            const isLiked = state.likedItems.has(item.id);
            const likeBtn = document.getElementById('modalLikeBtn');
            likeBtn.innerHTML = isLiked ? '<i class="fas fa-heart"></i> Liked' : '<i class="far fa-heart"></i> Like';
            likeBtn.dataset.id = item.id;

            // Open modal
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';

            // Mark as viewed
            state.viewedItems.add(item.id);
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Toggle like for an item
        function toggleLike(itemId) {
            if (state.likedItems.has(itemId)) {
                state.likedItems.delete(itemId);
                // Decrease like count
                const item = state.items.find(item => item.id === itemId);
                if (item) item.likes--;
            } else {
                state.likedItems.add(itemId);
                // Increase like count
                const item = state.items.find(item => item.id === itemId);
                if (item) item.likes++;

                // Show toast notification
                showToast('Image liked! ❤️');
            }

            // Update display
            updateDisplay();

            // Save liked items to localStorage
            saveLikedItems();
        }

        // Handle like in modal
        function handleLike() {
            const likeBtn = document.getElementById('modalLikeBtn');
            const itemId = parseInt(likeBtn.dataset.id);
            toggleLike(itemId);
            closeModal();
        }

        // Handle download
        function handleDownload() {
            const itemId = parseInt(document.getElementById('modalLikeBtn').dataset.id);
            const item = state.items.find(item => item.id === itemId);

            if (item) {
                // Increase download count
                item.downloads++;

                // Create a temporary link to download the image
                const link = document.createElement('a');
                link.href = item.imageUrl;
                link.download = `image-${item.id}.jpg`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // Show toast notification
                showToast('Download started! 📥');

                // Update modal downloads count
                document.getElementById('modalDownloads').textContent = item.downloads;

                // Update display
                updateDisplay();
            }
        }

        // Show toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Save state to localStorage
        function saveState() {
            const stateToSave = {
                currentPage: state.currentPage,
                itemsPerPage: state.itemsPerPage,
                viewMode: state.viewMode,
                searchQuery: state.searchQuery,
                selectedCategory: state.selectedCategory,
                sortBy: state.sortBy,
                darkMode: state.darkMode,
                lastScrollPosition: state.lastScrollPosition
            };

            localStorage.setItem('galleryState', JSON.stringify(stateToSave));
        }

        // Save liked items to localStorage
        function saveLikedItems() {
            localStorage.setItem('likedItems', JSON.stringify([...state.likedItems]));
        }

        // Restore state from localStorage
        function restoreState() {
            const savedState = localStorage.getItem('galleryState');
            const savedLikedItems = localStorage.getItem('likedItems');

            if (savedState) {
                try {
                    const parsedState = JSON.parse(savedState);

                    state.currentPage = parsedState.currentPage || 1;
                    state.itemsPerPage = parsedState.itemsPerPage || 10;
                    state.viewMode = parsedState.viewMode || 'pagination';
                    state.searchQuery = parsedState.searchQuery || '';
                    state.selectedCategory = parsedState.selectedCategory || 'all';
                    state.sortBy = parsedState.sortBy || 'id';
                    state.darkMode = parsedState.darkMode || false;

                    // Restore UI elements
                    document.getElementById('itemsPerPage').value = state.itemsPerPage;
                    document.getElementById('searchInput').value = state.searchQuery;
                    document.getElementById('categoryFilter').value = state.selectedCategory;
                    document.getElementById('sortBy').value = state.sortBy;

                    if (state.viewMode === 'pagination') {
                        document.getElementById('paginationView').classList.add('active');
                        document.getElementById('infiniteScrollView').classList.remove('active');
                    } else {
                        document.getElementById('infiniteScrollView').classList.add('active');
                        document.getElementById('paginationView').classList.remove('active');
                    }

                    // Apply dark mode
                    document.body.classList.toggle('dark-mode', state.darkMode);
                    document.getElementById('darkModeToggle').innerHTML =
                        state.darkMode ? '<i class="fas fa-sun"></i> Light Mode' : '<i class="fas fa-moon"></i> Dark Mode';

                    // Update display
                    updateDisplay();

                    // Restore scroll position
                    setTimeout(() => {
                        window.scrollTo(0, parsedState.lastScrollPosition || 0);
                    }, 100);

                } catch (e) {
                    console.log('Error restoring state:', e);
                }
            }

            // Restore liked items
            if (savedLikedItems) {
                try {
                    state.likedItems = new Set(JSON.parse(savedLikedItems));
                } catch (e) {
                    console.log('Error restoring liked items:', e);
                }
            }
        }
    </script>
</body>

</html>